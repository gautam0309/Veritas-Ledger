<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Blockchain Certificate - Verification Portal</title>
    <base href="/">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="stylesheets/style.css">
</head>

<body>
    <div class="app-wrapper">
        <%- include('partials/navbar-partial.ejs') %>
            <div class="page-bg-overlay">
                <div class="bg-grid"></div>
                <div class="bg-dots"></div>
                <div class="bg-shape bg-shape-1"></div>
                <div class="bg-shape bg-shape-2"></div>
            </div>

            <div class="auth-section py-5">
                <div class="auth-container mx-auto" style="max-width: 700px;">
                    <div class="auth-logo mb-4">
                        <div class="logo-box mx-auto d-flex align-items-center justify-content-center"
                            style="width: 60px; height: 60px; background: var(--primary-gradient); border-radius: 15px; color: white;">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                <path d="M8 11h8M12 7v8"></path>
                            </svg>
                        </div>
                    </div>

                    <div class="auth-header text-center mb-4">
                        <h1 class="h3 font-weight-bold" style="color: var(--primary);">Verification Gateway</h1>
                        <p class="text-secondary small">Verify the authenticity of any Veritas Ledger certificate.</p>
                    </div>

                    <article class="auth-body">
                        <ul class="nav nav-tabs mb-4 justify-content-center border-0" id="verifyTabs" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active px-4 py-2" id="rollno-tab" data-toggle="tab"
                                    href="#rollnoPane" role="tab"
                                    style="border-radius: 10px 0 0 10px; font-weight: 600;">By Roll Number</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link px-4 py-2" id="qr-tab" data-toggle="tab" href="#qrPane" role="tab"
                                    style="border-radius: 0 10px 10px 0; font-weight: 600;">By QR Code</a>
                            </li>
                        </ul>

                        <div class="tab-content" id="verifyTabsContent">
                            <!-- Roll Number Pane -->
                            <div class="tab-pane fade show active" id="rollnoPane" role="tabpanel">
                                <form action="/verify/rollnumber" method="POST">
                                    <div class="form-group mb-4">
                                        <label class="small font-weight-bold text-secondary">Roll Number</label>
                                        <input name="rollNumber" required type="text" class="form-control py-4"
                                            placeholder="Enter student roll number" style="border-radius: 12px;">
                                    </div>
                                    <button type="submit"
                                        class="btn btn-primary btn-block py-3 font-weight-bold shadow-sm"
                                        style="border-radius: 12px;">Verify Identity</button>
                                </form>
                            </div>

                            <!-- QR Code Pane -->
                            <div class="tab-pane fade text-center" id="qrPane" role="tabpanel">
                                <div class="qr-upload-box p-5 border-dashed"
                                    style="border: 2px dashed var(--border-color); border-radius: 20px; background: var(--bg-secondary);">
                                    <i data-feather="camera"
                                        style="width: 48px; height: 48px; color: var(--text-muted);" class="mb-3"></i>
                                    <p class="text-secondary mb-3">Scan or upload certificate QR code</p>
                                    <button class="btn btn-outline-primary px-4" style="border-radius: 10px;">Open
                                        Camera</button>
                                </div>
                            </div>
                        </div>
                    </article>

                    <div class="auth-footer text-center mt-4">
                        <a href="/" class="back-link-modern"><i data-feather="arrow-left"></i> Back to Homepage</a>
                    </div>
                </div>
            </div>

            <%- include('partials/footer-partial.ejs') %>
    </div>

</body>

</html>
<script nonce="<%= nonce %>">
    // If URL has ?proof= parameter (from QR code scan), auto-fill and submit
    $(document).ready(function () {
        const urlParams = new URLSearchParams(window.location.search);
        const proofParam = urlParams.get('proof');
        if (proofParam) {
            try {
                const proofJSON = atob(proofParam);
                $('#qr-tab').tab('show');
                // Auto-submit logic would go here if needed for QR
            } catch (e) {
                console.error("Invalid proof parameter", e);
            }
        }
    });
</script>